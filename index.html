<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Cyber Analyst Mission Control</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body class="bg-slate-50 text-slate-900">
  <!-- Top bar -->
  <header class="w-full border-b bg-white sticky top-0 z-50">
    <div class="max-w-7xl mx-auto flex items-center gap-3 p-3">
      <h1 class="text-xl font-semibold">Cyber Analyst Mission Control</h1>
      <input id="globalSearch" type="search" placeholder="Search tools, runbooks, links" class="ml-auto w-80 px-3 py-2 border rounded-md focus:outline-none focus:ring" />
      <button id="themeToggle" class="px-3 py-2 border rounded-md">Theme</button>
    </div>
  </header>

  <!-- Three-column layout -->
  <main class="max-w-7xl mx-auto grid grid-cols-12 gap-4 p-4">
    <!-- Left rail -->
    <aside class="col-span-3 hidden lg:block">
      <nav id="leftNav" class="space-y-3">

        <!-- Networking -->
        <section class="bg-white border rounded-md">
          <button data-collapse="#grp-networking" class="w-full flex items-center justify-between p-3">
            <span class="font-medium">Networking</span><span>▾</span>
          </button>
          <div id="grp-networking" class="p-2 border-t space-y-1">
            <button data-tool="cidr" class="nav-item">CIDR Calculator</button>
            <button data-tool="wildcard" class="nav-item">Wildcard Mask</button>
            <button data-tool="baseConv" class="nav-item">Hex ↔ Dec</button>
            <button data-tool="timestamp" class="nav-item">Timestamp Converter</button>
          </div>
        </section>

        <!-- Crypto & Encoding -->
        <section class="bg-white border rounded-md">
          <button data-collapse="#grp-crypto" class="w-full flex items-center justify-between p-3">
            <span class="font-medium">Crypto & Encoding</span><span>▾</span>
          </button>
          <div id="grp-crypto" class="p-2 border-t space-y-1">
            <button data-tool="base64" class="nav-item">Base64 Encode/Decode</button>
          </div>
        </section>

        <!-- Risk & Governance -->
        <section class="bg-white border rounded-md">
          <button data-collapse="#grp-risk" class="w-full flex items-center justify-between p-3">
            <span class="font-medium">Risk & Governance</span><span>▾</span>
          </button>
          <div id="grp-risk" class="p-2 border-t space-y-1">
            <button data-tool="ale" class="nav-item">ALE / SLE / ARO Calculator</button>
            <button data-tool="cvss" class="nav-item">CVSS v3.1 Vector Helper</button>
          </div>
        </section>

        <!-- SIEM & Detection -->
        <section class="bg-white border rounded-md">
          <button data-collapse="#grp-siem" class="w-full flex items-center justify-between p-3">
            <span class="font-medium">SIEM & Detection</span><span>▾</span>
          </button>
          <div id="grp-siem" class="p-2 border-t space-y-1">
            <button data-tool="kqlCheat" class="nav-item">KQL Cheat Sheet</button>
            <button data-tool="splCheat" class="nav-item">SPL Cheat Sheet</button>
            <button data-tool="regex" class="nav-item">Regex Tester</button>
          </div>
        </section>

        <!-- Runbooks -->
        <section class="bg-white border rounded-md">
          <button data-collapse="#grp-runbooks" class="w-full flex items-center justify-between p-3">
            <span class="font-medium">Runbooks</span><span>▾</span>
          </button>
          <div id="grp-runbooks" class="p-2 border-t space-y-1">
            <button data-tool="runbook" data-runbook="ransomware" class="nav-item">Ransomware Suspected</button>
            <button data-tool="runbook" data-runbook="unauth" class="nav-item">Unauthorized Access</button>
            <button data-tool="runbook" data-runbook="phishing" class="nav-item">Phishing Wave</button>
            <button data-tool="runbook" data-runbook="exfil" class="nav-item">Active Data Exfiltration</button>
            <button data-tool="runbook" data-runbook="lateral" class="nav-item">Lateral Movement</button>
            <button data-tool="runbook" data-runbook="webshell" class="nav-item">Web Shell Suspected</button>
            <button data-tool="runbook" data-runbook="ddos" class="nav-item">DDoS / Edge Exploitation</button>
            <button data-tool="runbook" data-runbook="insider" class="nav-item">Insider Data Mishandling</button>
            <button data-tool="runbook" data-runbook="lostdevice" class="nav-item">Lost/Stolen Device</button>
          </div>
        </section>

        <!-- Gold Links -->
        <section class="bg-white border rounded-md">
          <button data-collapse="#grp-links" class="w-full flex items-center justify-between p-3">
            <span class="font-medium">Gold Links</span><span>▾</span>
          </button>
          <div id="grp-links" class="p-2 border-t space-y-1">
            <button data-tool="goldLinks" class="nav-item">Curated Docs & References</button>
          </div>
        </section>
      </nav>
    </aside>

    <!-- Main content -->
    <section id="main" class="col-span-12 lg:col-span-6 min-h-[70vh] space-y-4">
      <!-- Dashboard -->
      <div id="view-dashboard" class="view">
        <div class="bg-white border rounded-md p-4">
          <h2 class="text-lg font-semibold mb-2">Dashboard</h2>
          <p class="text-sm">Quick access to favorites and recent tools.</p>
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 mt-3">
            <button data-tool="base64" class="card-link">Open Base64</button>
            <button data-tool="cidr" class="card-link">Open CIDR</button>
            <button data-tool="wildcard" class="card-link">Open Wildcard</button>
            <button data-tool="kqlCheat" class="card-link">Open KQL</button>
          </div>
        </div>
      </div>

      <!-- Base64 -->
      <div id="view-base64" class="view hidden bg-white border rounded-md p-4">
        <div class="flex items-center justify-between">
          <h2 class="text-lg font-semibold">Base64 Encode/Decode</h2>
          <div class="text-xs text-slate-500">Client side only</div>
        </div>
        <div class="grid2 mt-3">
          <div>
            <label class="text-sm">Input</label>
            <textarea id="b64-in" class="w-full h-48 border rounded-md p-2 mono"></textarea>
            <div class="flex gap-2 mt-2">
              <button id="b64-encode" class="btn">Encode</button>
              <button id="b64-decode" class="btn">Decode</button>
              <button id="b64-clear" class="btn">Clear</button>
            </div>
          </div>
          <div>
            <label class="text-sm">Output</label>
            <textarea id="b64-out" class="w-full h-48 border rounded-md p-2 mono" readonly></textarea>
            <div class="flex gap-2 mt-2">
              <button id="b64-copy" class="btn">Copy</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Wildcard Mask -->
      <div id="view-wildcard" class="view hidden bg-white border rounded-md p-4">
        <h2 class="text-lg font-semibold">Wildcard Mask Calculator</h2>
        <div class="mt-3 grid2">
          <div class="border rounded-md p-3">
            <h3 class="font-medium text-sm mb-2">From Subnet Mask</h3>
            <label class="text-sm">Subnet mask (e.g., 255.255.255.0)</label>
            <input id="wm-subnet" class="w-full border rounded-md px-2 py-1 mt-1 mono" placeholder="255.255.255.0">
            <button id="wm-fromMask" class="btn mt-2">Calculate</button>
          </div>
          <div class="border rounded-md p-3">
            <h3 class="font-medium text-sm mb-2">Result</h3>
            <div class="text-sm">Wildcard mask</div>
            <input id="wm-out-fromMask" class="w-full border rounded-md px-2 py-1 mt-1 mono" readonly>
          </div>
        </div>
        <div class="mt-4 grid3">
          <div class="border rounded-md p-3">
            <h3 class="font-medium text-sm mb-2">From CIDR Prefix</h3>
            <label class="text-sm">Prefix length 0–32</label>
            <input id="wm-cidr" type="number" min="0" max="32" class="w-full border rounded-md px-2 py-1 mt-1" placeholder="24">
            <button id="wm-fromCidr" class="btn mt-2">Calculate</button>
          </div>
          <div class="border rounded-md p-3">
            <h3 class="font-medium text-sm mb-2">Subnet mask</h3>
            <input id="wm-out-mask" class="w-full border rounded-md px-2 py-1 mono" readonly>
          </div>
          <div class="border rounded-md p-3">
            <h3 class="font-medium text-sm mb-2">Wildcard mask</h3>
            <input id="wm-out-wild" class="w-full border rounded-md px-2 py-1 mono" readonly>
          </div>
        </div>
      </div>

      <!-- Hex ↔ Dec -->
      <div id="view-baseConv" class="view hidden bg-white border rounded-md p-4">
        <h2 class="text-lg font-semibold">Hex ↔ Dec Converter</h2>
        <div class="grid2 mt-3">
          <div class="border rounded-md p-3">
            <label class="text-sm">Decimal → Hex</label>
            <input id="dec-in" class="w-full border rounded-md px-2 py-1 mt-1 mono" placeholder="65535">
            <button id="dec-to-hex" class="btn mt-2">Convert</button>
            <input id="dec-hex-out" class="w-full border rounded-md px-2 py-1 mt-2 mono" readonly>
          </div>
          <div class="border rounded-md p-3">
            <label class="text-sm">Hex → Decimal</label>
            <input id="hex-in" class="w-full border rounded-md px-2 py-1 mt-1 mono" placeholder="0xFFFF or FFFF">
            <button id="hex-to-dec" class="btn mt-2">Convert</button>
            <input id="hex-dec-out" class="w-full border rounded-md px-2 py-1 mt-2 mono" readonly>
          </div>
        </div>
      </div>

      <!-- Timestamp converter -->
      <div id="view-timestamp" class="view hidden bg-white border rounded-md p-4">
        <h2 class="text-lg font-semibold">Timestamp Converter</h2>
        <div class="grid3 mt-3">
          <div class="border rounded-md p-3">
            <label class="text-sm">Unix epoch (seconds)</label>
            <input id="ts-epoch" class="w-full border rounded-md px-2 py-1 mt-1 mono" placeholder="1718192000">
            <button id="ts-from-epoch" class="btn mt-2">Epoch → Human</button>
          </div>
          <div class="border rounded-md p-3">
            <label class="text-sm">Human (YYYY-MM-DD HH:mm:ss)</label>
            <input id="ts-human" class="w-full border rounded-md px-2 py-1 mt-1 mono" placeholder="2025-06-12 15:30:00">
            <button id="ts-to-epoch" class="btn mt-2">Human → Epoch</button>
          </div>
          <div class="border rounded-md p-3">
            <label class="text-sm">Results</label>
            <textarea id="ts-out" class="w-full h-28 border rounded-md p-2 mono" readonly></textarea>
          </div>
        </div>
      </div>

      <!-- ALE/SLE/ARO -->
      <div id="view-ale" class="view hidden bg-white border rounded-md p-4">
        <h2 class="text-lg font-semibold">ALE / SLE / ARO Calculator</h2>
        <div class="grid3 mt-3">
          <div class="border rounded-md p-3">
            <label class="text-sm">Asset Value (AV)</label>
            <input id="av" class="w-full border rounded-md px-2 py-1 mt-1 mono" placeholder="100000">
            <label class="text-sm mt-3 block">Exposure Factor (EF, 0–1)</label>
            <input id="ef" class="w-full border rounded-md px-2 py-1 mt-1 mono" placeholder="0.3">
            <label class="text-sm mt-3 block">Annualized Rate of Occurrence (ARO)</label>
            <input id="aro" class="w-full border rounded-md px-2 py-1 mt-1 mono" placeholder="0.2">
            <button id="calc-ale" class="btn mt-2">Calculate</button>
          </div>
          <div class="border rounded-md p-3 col-span-2">
            <label class="text-sm">Results</label>
            <textarea id="ale-out" class="w-full h-40 border rounded-md p-2 mono" readonly></textarea>
          </div>
        </div>
      </div>

      <!-- CVSS v3.1 helper -->
      <div id="view-cvss" class="view hidden bg-white border rounded-md p-4">
        <h2 class="text-lg font-semibold">CVSS v3.1 Vector Helper</h2>
        <p class="text-sm text-slate-600">Build a base vector then open in FIRST/NVD calculators for official scoring.</p>
        <div class="grid2 mt-3">
          <div class="border rounded-md p-3">
            <div class="grid grid-cols-2 gap-2 text-sm">
              <label>AV</label>
              <select id="cvss-av" class="border rounded px-2 py-1">
                <option value="AV:N">Network</option><option value="AV:A">Adjacent</option><option value="AV:L">Local</option><option value="AV:P">Physical</option>
              </select>
              <label>AC</label>
              <select id="cvss-ac" class="border rounded px-2 py-1">
                <option value="AC:L">Low</option><option value="AC:H">High</option>
              </select>
              <label>PR</label>
              <select id="cvss-pr" class="border rounded px-2 py-1">
                <option value="PR:N">None</option><option value="PR:L">Low</option><option value="PR:H">High</option>
              </select>
              <label>UI</label>
              <select id="cvss-ui" class="border rounded px-2 py-1">
                <option value="UI:N">None</option><option value="UI:R">Required</option>
              </select>
              <label>S</label>
              <select id="cvss-s" class="border rounded px-2 py-1">
                <option value="S:U">Unchanged</option><option value="S:C">Changed</option>
              </select>
              <label>C</label>
              <select id="cvss-c" class="border rounded px-2 py-1">
                <option value="C:N">None</option><option value="C:L">Low</option><option value="C:H">High</option>
              </select>
              <label>I</label>
              <select id="cvss-i" class="border rounded px-2 py-1">
                <option value="I:N">None</option><option value="I:L">Low</option><option value="I:H">High</option>
              </select>
              <label>A</label>
              <select id="cvss-a" class="border rounded px-2 py-1">
                <option value="A:N">None</option><option value="A:L">Low</option><option value="A:H">High</option>
              </select>
            </div>
            <button id="cvss-build" class="btn mt-3">Build Vector</button>
          </div>
          <div class="border rounded-md p-3">
            <label class="text-sm">Vector</label>
            <input id="cvss-vector" class="w-full border rounded px-2 py-1 mono" readonly>
            <div class="flex gap-2 mt-2 text-sm">
              <a id="cvss-first" class="a" target="_blank">Open in FIRST</a>
              <a id="cvss-nvd" class="a" target="_blank">Open in NVD</a>
            </div>
            <div class="text-xs text-slate-500 mt-2">Use official calculators for exact scoring.</div>
          </div>
        </div>
      </div>

      <!-- KQL cheat sheet -->
      <div id="view-kqlCheat" class="view hidden bg-white border rounded-md p-4">
        <h2 class="text-lg font-semibold">KQL Cheat Sheet</h2>
        <div id="kql-body" class="mt-3 space-y-3"></div>
      </div>

      <!-- SPL cheat sheet -->
      <div id="view-splCheat" class="view hidden bg-white border rounded-md p-4">
        <h2 class="text-lg font-semibold">SPL Cheat Sheet</h2>
        <div id="spl-body" class="mt-3 space-y-3"></div>
      </div>

      <!-- Regex tester -->
      <div id="view-regex" class="view hidden bg-white border rounded-md p-4">
        <h2 class="text-lg font-semibold">Regex Tester</h2>
        <div class="grid2 mt-3">
          <div class="border rounded-md p-3">
            <label class="text-sm">Pattern (JS)</label>
            <input id="re-pattern" class="w-full border rounded px-2 py-1 mono" placeholder="(GET|POST)\\s+(/\\S*)">
            <label class="text-sm mt-2 block">Flags</label>
            <input id="re-flags" class="w-full border rounded px-2 py-1 mono" placeholder="gi">
            <label class="text-sm mt-2 block">Text</label>
            <textarea id="re-text" class="w-full h-40 border rounded p-2 mono" placeholder="Paste sample text or logs here"></textarea>
            <button id="re-run" class="btn mt-2">Run</button>
          </div>
          <div class="border rounded-md p-3">
            <label class="text-sm">Matches</label>
            <textarea id="re-out" class="w-full h-56 border rounded p-2 mono" readonly></textarea>
          </div>
        </div>
      </div>

      <!-- Runbook renderer -->
      <div id="view-runbook" class="view hidden bg-white border rounded-md p-4">
        <h2 id="rb-title" class="text-lg font-semibold">Runbook</h2>
        <div class="mt-2">
          <div class="tabs mb-3">
            <button class="tab active" data-tab="#rb-quick">5 minute actions</button>
            <button class="tab" data-tab="#rb-full">Full checklist</button>
          </div>
          <div id="rb-quick" class="tabview"></div>
          <div id="rb-full" class="tabview hidden"></div>
        </div>
      </div>

      <!-- Gold links -->
      <div id="view-goldLinks" class="view hidden bg-white border rounded-md p-4">
        <h2 class="text-lg font-semibold">Curated Docs & References</h2>
        <ul class="list-disc ml-5 mt-2 text-sm space-y-1">
          <li><a class="a" href="https://learn.microsoft.com/en-us/kusto/query" target="_blank">Kusto Query Language Docs</a></li>
          <li><a class="a" href="https://learn.microsoft.com/en-us/azure/sentinel" target="_blank">Microsoft Sentinel Docs</a></li>
          <li><a class="a" href="https://attack.mitre.org/matrices/enterprise/" target="_blank">MITRE ATT&CK Enterprise Matrix</a></li>
          <li><a class="a" href="https://www.cisa.gov/known-exploited-vulnerabilities-catalog" target="_blank">CISA KEV Catalog</a></li>
          <li><a class="a" href="https://nvd.nist.gov/vuln/search" target="_blank">NVD CVE Search</a></li>
          <li><a class="a" href="https://www.nist.gov/cyberframework" target="_blank">NIST CSF</a></li>
          <li><a class="a" href="https://docs.splunk.com/Documentation/Splunk/9.4.2/SearchReference/WhatsInThisManual" target="_blank">Splunk SPL Search Reference</a></li>
          <li><a class="a" href="https://docs.paloaltonetworks.com/" target="_blank">Palo Alto Networks Tech Docs</a></li>
          <li><a class="a" href="https://www.first.org/cvss/calculator/3-1" target="_blank">FIRST CVSS v3.1 Calculator</a></li>
          <li><a class="a" href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator" target="_blank">NVD CVSS v3 Calculator</a></li>
          <li><a class="a" href="https://github.com/SigmaHQ/sigma" target="_blank">Sigma Rules</a></li>
          <li><a class="a" href="https://atomicredteam.io/" target="_blank">Atomic Red Team</a></li>
        </ul>
      </div>
    </section>

    <!-- Right rail -->
    <aside class="col-span-3 hidden lg:block space-y-4">
      <div class="bg-white border rounded-md p-4">
        <h3 class="font-semibold mb-2">Related Links</h3>
        <ul id="relatedLinks" class="text-sm list-disc ml-5 space-y-1"></ul>
      </div>
      <div class="bg-white border rounded-md p-4">
        <h3 class="font-semibold mb-2">Personal Quick Links</h3>
        <div class="flex gap-2 mb-2">
          <input id="ql-url" class="flex-1 border rounded-md px-2 py-1" placeholder="https://example.com">
          <button id="ql-add" class="btn">Add</button>
        </div>
        <ul id="ql-list" class="text-sm list-disc ml-5 space-y-1"></ul>
      </div>
      <div class="bg-white border rounded-md p-4">
        <h3 class="font-semibold mb-2">Notes</h3>
        <textarea id="notes" class="w-full h-32 border rounded-md p-2" placeholder="Temporary scratchpad"></textarea>
        <div class="text-xs text-slate-500 mt-1">Auto saved locally</div>
      </div>
    </aside>
  </main>

  <script src="script.js"></script>
</body>
</html>
